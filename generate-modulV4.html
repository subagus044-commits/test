<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Rencana Pembelajaran Mendalam - Deep Learning</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .blur-loading { filter: blur(4px); transition: filter 0.3s; }
        .blink { animation: blinker 1.5s linear infinite; color: #2563eb; font-weight: bold; }
        @keyframes blinker { 50% { opacity: 0; } }
        /* Print/Doc styles */
        .doc-preview { font-family: 'Times New Roman', serif; line-height: 1.15; color: #000; font-size: 11pt; }
        .doc-preview table { width: 100%; border-collapse: collapse; margin-bottom: 1rem; border: 1px solid black; }
        .doc-preview th, .doc-preview td { border: 1px solid black; padding: 6px; vertical-align: top; }
        .doc-preview h1, .doc-preview h2, .doc-preview h3, .doc-preview h4 { color: black; margin-top: 10px; margin-bottom: 5px; font-weight: bold; }
        .doc-preview ul, .doc-preview ol { padding-left: 20px; margin: 5px 0; }
        .bg-gray-200 { background-color: #e5e7eb; }
        
        /* Modal Animation */
        .modal-enter { opacity: 0; transform: scale(0.9); }
        .modal-enter-active { opacity: 1; transform: scale(1); transition: opacity 300ms, transform 300ms; }
        .modal-exit { opacity: 1; transform: scale(1); }
        .modal-exit-active { opacity: 0; transform: scale(0.9); transition: opacity 300ms, transform 300ms; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            // State untuk Input
            const [apiKey, setApiKey] = useState('');
            const [formData, setFormData] = useState({
                sekolah: '',
                tahun: '',
                semester: 'Ganjil',
                guru: '',
                nipGuru: '',
                kepsek: '',
                nipKepsek: '',
                jenjang: 'SMK',
                mapel: '',
                kelas: '10',
                cp: '',
                materi: '',
                tujuan: '',
                waktu: '',
                model: 'Problem Based Learning (PBL)',
                profil: '' // Akan diisi string gabungan dari checkbox
            });

            // State untuk Loading & Hasil
            const [isLoading, setIsLoading] = useState(false);
            const [result, setResult] = useState(null); 
            const [error, setError] = useState('');
            
            // State untuk Modal Panduan
            const [showGuide, setShowGuide] = useState(false);

            // Pilihan Jenjang & Kelas
            const classOptions = {
                'SD': ['1', '2', '3', '4', '5', '6'],
                'SMP': ['7', '8', '9'],
                'SMA': ['10', '11', '12'],
                'SMK': ['10', '11', '12']
            };

            const modelOptions = [
                "Problem Based Learning (PBL)",
                "Project Based Learning (PjBL)",
                "Discovery Learning",
                "Inquiry Learning",
                "Kooperatif Jigsaw",
                "Teaching Factory (TeFa)"
            ];

            // Daftar Pilihan Profil Lulusan Baru
            const profilLulusanOptions = [
                "Keimanan dan Ketakwaan terhadap Tuhan YME",
                "Kewargaan",
                "Kreativitas",
                "Kemandirian",
                "Penalaran Kritis",
                "Kolaborasi",
                "Komunikasi",
                "Kesehatan"
            ];

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => {
                    const newData = { ...prev, [name]: value };
                    if (name === 'jenjang') {
                        newData.kelas = classOptions[value][0];
                    }
                    return newData;
                });
            };

            // Handler Khusus Checkbox Profil
            const handleProfilChange = (option) => {
                let currentProfils = formData.profil ? formData.profil.split(', ').filter(item => item.trim() !== '') : [];
                
                if (currentProfils.includes(option)) {
                    // Jika sudah ada, hapus (uncheck)
                    currentProfils = currentProfils.filter(item => item !== option);
                } else {
                    // Jika belum ada, tambahkan (check)
                    currentProfils.push(option);
                }

                setFormData(prev => ({
                    ...prev,
                    profil: currentProfils.join(', ')
                }));
            };

            const generateContent = async () => {
                if (!apiKey) {
                    alert("Mohon masukkan Google API Key terlebih dahulu. Klik menu PANDUAN untuk cara mendapatkannya.");
                    return;
                }
                
                setIsLoading(true);
                setError('');
                setResult(null);

                // Prompt disesuaikan SANGAT SPESIFIK dengan struktur template yang diminta
                const prompt = `
                    Bertindaklah sebagai Guru Profesional berpengalaman. Buatkan **PERENCANAAN PEMBELAJARAN MENDALAM** yang **SAMA PERSIS** strukturnya dengan permintaan berikut.

                    **DATA INPUT:**
                    Sekolah: ${formData.sekolah}
                    Guru: ${formData.guru}
                    Mapel: ${formData.mapel}
                    Kelas: ${formData.kelas} / Semester: ${formData.semester}
                    Alokasi Waktu: ${formData.waktu}
                    Materi: ${formData.materi}
                    DPL (Profil Lulusan): ${formData.profil}
                    CP: ${formData.cp}
                    TP: ${formData.tujuan}
                    Model: ${formData.model}

                    **ATURAN SANGAT PENTING (PRINSIP PEMBELAJARAN):**
                    Anda **HANYA** boleh memilih prinsip dari daftar tertutup ini:
                    1. **Berkesadaran**
                    2. **Bermakna**
                    3. **Menggembirakan**

                    **DILARANG KERAS** menggunakan kata lain seperti "Reflektif", "Memberdayakan", "Menantang", "Kritis", dll. HANYA gunakan 3 kata di atas.

                    Untuk setiap tahapan (Awal, Memahami, Mengaplikasi, Merefleksi, Penutup), pilih **TEPAT 2** dari 3 kata tersebut.
                    Contoh yang BENAR: "(Prinsip: Berkesadaran, Bermakna)"
                    Contoh yang SALAH: "(Prinsip: Berkesadaran, Reflektif)" -> SALAH karena Reflektif tidak ada di daftar.

                    **INSTRUKSI STRUKTUR OUTPUT (WAJIB DIIKUTI):**
                    Hasilkan HTML Table untuk setiap bagian ini secara berurutan:
                    1. **IDENTIFIKASI**: Tabel berisi baris (Peserta Didik, Materi Pelajaran, Dimensi Profil Lulusan).
                    2. **DESAIN PEMBELAJARAN**: Tabel berisi baris (Capaian Pembelajaran, Lintas Disiplin Ilmu, Tujuan Pembelajaran, Topik Pembelajaran, Praktik Pedagogis, Kemitraan Pembelajaran, Lingkungan Pembelajaran, Pemanfaatan Digital).
                    3. **PENGALAMAN BELAJAR**:
                       - Tabel struktur khusus.
                       - Bagian AWAL: Sertakan kolom prinsip (Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan).
                       - Bagian INTI: Pecah menjadi **Memahami**, **Mengaplikasi**, **Merefleksi**. Di sebelah setiap tahapan ini, tuliskan prinsipnya (Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan).
                       - Bagian PENUTUP: Sertakan kolom prinsip (Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan).
                    4. **ASESMEN**: Tabel berisi baris (Asesmen pada Awal Pembelajaran, Asesmen pada Proses Pembelajaran, Asesmen pada Akhir Pembelajaran).
                    5. **LAMPIRAN**: Daftar Rubrik dan Instrumen (Hanya judulnya saja di modul ini, isinya di file Asesmen).

                    **FORMAT HTML OUTPUT (JSON "modul"):**
                    Gunakan style 'border-collapse: collapse; width: 100%; border: 1px solid black;' untuk semua tabel.
                    
                    <div style="font-family: 'Times New Roman', serif; font-size: 11pt;">
                        <h2 style="text-align: center; font-weight: bold; margin-bottom: 0;">PERENCANAAN PEMBELAJARAN MENDALAM</h2>
                        <br>
                        
                        <!-- HEADER -->
                        <table border="0" style="width: 100%; font-weight: bold; border: 0;">
                            <tr><td style="width: 25%; border: 0;">SEKOLAH</td><td style="border: 0;">: ${formData.sekolah}</td></tr>
                            <tr><td style="border: 0;">NAMA GURU</td><td style="border: 0;">: ${formData.guru}</td></tr>
                            <tr><td style="border: 0;">MATA PELAJARAN</td><td style="border: 0;">: ${formData.mapel}</td></tr>
                            <tr><td style="border: 0;">KELAS / SEMESTER</td><td style="border: 0;">: ${formData.kelas} / ${formData.semester}</td></tr>
                            <tr><td style="border: 0;">ALOKASI WAKTU</td><td style="border: 0;">: ${formData.waktu}</td></tr>
                        </table>
                        <br>

                        <!-- 1. IDENTIFIKASI -->
                        <div style="font-weight: bold; margin-bottom: 5px;">IDENTIFIKASI</div>
                        <table border="1" style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                            <tr>
                                <td style="width: 30%; padding: 5px;">Peserta Didik</td>
                                <td style="padding: 5px;">Reguler</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Materi Pelajaran</td>
                                <td style="padding: 5px;">${formData.materi}</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Dimensi Profil Lulusan (DPL)</td>
                                <td style="padding: 5px;">${formData.profil}</td>
                            </tr>
                        </table>
                        <br>

                        <!-- 2. DESAIN PEMBELAJARAN -->
                        <div style="font-weight: bold; margin-bottom: 5px;">DESAIN PEMBELAJARAN</div>
                        <table border="1" style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                            <tr>
                                <td style="width: 30%; padding: 5px;">Capaian Pembelajaran</td>
                                <td style="padding: 5px;">${formData.cp}</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Lintas Disiplin Ilmu</td>
                                <td style="padding: 5px;">(Isi otomatis yang relevan, misal: Bahasa Indonesia untuk komunikasi hasil)</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Tujuan Pembelajaran</td>
                                <td style="padding: 5px;">${formData.tujuan}</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Topik Pembelajaran</td>
                                <td style="padding: 5px;">${formData.materi}</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Praktik Pedagogis</td>
                                <td style="padding: 5px;">${formData.model} (Student Centered Learning)</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Kemitraan Pembelajaran</td>
                                <td style="padding: 5px;">(Isi otomatis yang relevan, misal: Orang Tua / Pakar Tamu / Industri)</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Lingkungan Pembelajaran</td>
                                <td style="padding: 5px;">(Isi otomatis, misal: Ruang Kelas, Perpustakaan, atau Lingkungan Sekolah)</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Pemanfaatan Digital</td>
                                <td style="padding: 5px;">(Isi otomatis, misal: Video Pembelajaran, LMS, Quizizz, Google Form)</td>
                            </tr>
                        </table>
                        <br>

                        <!-- 3. PENGALAMAN BELAJAR -->
                        <div style="font-weight: bold; margin-bottom: 5px;">PENGALAMAN BELAJAR</div>
                        <table border="1" style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                            <!-- AWAL -->
                            <tr>
                                <td style="width: 30%; font-weight: bold; padding: 5px; background-color: #f0f0f0;">
                                    AWAL<br>
                                    <span style="font-weight: normal; font-style: italic; font-size: 10pt;">(Prinsip: [Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan])</span>
                                </td>
                                <td style="padding: 5px;">
                                    (Deskripsikan kegiatan pendahuluan lengkap disini)
                                </td>
                            </tr>
                            
                            <!-- INTI -->
                            <tr>
                                <td colspan="2" style="font-weight: bold; padding: 5px; background-color: #dbeafe; text-align: center;">INTI</td>
                            </tr>
                            <tr>
                                <td style="width: 30%; font-weight: bold; padding: 5px;">
                                    Memahami<br>
                                    <span style="font-weight: normal; font-style: italic; font-size: 10pt;">(Prinsip: [Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan])</span>
                                </td>
                                <td style="padding: 5px;">
                                    (Deskripsikan kegiatan 'Memahami'. Integrasikan sintaks awal model ${formData.model} disini)
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 30%; font-weight: bold; padding: 5px;">
                                    Mengaplikasi<br>
                                    <span style="font-weight: normal; font-style: italic; font-size: 10pt;">(Prinsip: [Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan])</span>
                                </td>
                                <td style="padding: 5px;">
                                    (Deskripsikan kegiatan 'Mengaplikasi'. Integrasikan sintaks inti model ${formData.model} disini)
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 30%; font-weight: bold; padding: 5px;">
                                    Merefleksi<br>
                                    <span style="font-weight: normal; font-style: italic; font-size: 10pt;">(Prinsip: [Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan])</span>
                                </td>
                                <td style="padding: 5px;">
                                    (Deskripsikan kegiatan 'Merefleksi'. Integrasikan sintaks akhir model ${formData.model} disini)
                                </td>
                            </tr>

                            <!-- PENUTUP -->
                            <tr>
                                <td style="width: 30%; font-weight: bold; padding: 5px; background-color: #f0f0f0;">
                                    PENUTUP<br>
                                    <span style="font-weight: normal; font-style: italic; font-size: 10pt;">(Prinsip: [Pilih 2 dari: Berkesadaran, Bermakna, Menggembirakan])</span>
                                </td>
                                <td style="padding: 5px;">
                                    (Deskripsikan kegiatan penutup lengkap disini)
                                </td>
                            </tr>
                        </table>
                        <br>

                        <!-- 4. ASESMEN -->
                        <div style="font-weight: bold; margin-bottom: 5px;">ASESMEN</div>
                        <table border="1" style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                            <tr>
                                <td style="width: 30%; padding: 5px;">Asesmen pada Awal Pembelajaran</td>
                                <td style="padding: 5px;">(Deskripsi instrumen diagnostik kognitif/non-kognitif)</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Asesmen pada Proses Pembelajaran</td>
                                <td style="padding: 5px;">(Deskripsi instrumen formatif, observasi sikap, LKPD)</td>
                            </tr>
                            <tr>
                                <td style="padding: 5px;">Asesmen pada Akhir Pembelajaran</td>
                                <td style="padding: 5px;">(Deskripsi instrumen sumatif/projek/tes tulis)</td>
                            </tr>
                        </table>
                        <br>

                        <!-- 5. LAMPIRAN -->
                        <div style="font-weight: bold; margin-bottom: 5px;">LAMPIRAN</div>
                        <div style="border: 1px solid black; padding: 10px;">
                            <b>RUBRIK ASESMEN:</b>
                            <ul style="margin-top: 0;">
                                <li>Asesmen pada Awal Pembelajaran (Terlampir)</li>
                                <li>Asesmen pada Proses Pembelajaran (Terlampir)</li>
                                <li>Asesmen pada Akhir Pembelajaran (Terlampir)</li>
                            </ul>
                            <b>INSTRUMEN ASESMEN:</b>
                            <ul style="margin-top: 0;">
                                <li>Asesmen pada Awal Pembelajaran (Terlampir)</li>
                                <li>Asesmen pada Proses Pembelajaran (Terlampir)</li>
                                <li>Asesmen pada Akhir Pembelajaran (Terlampir)</li>
                            </ul>
                        </div>
                        <br><br>

                        <!-- TTD -->
                        <table border="0" style="width: 100%; border: 0;">
                            <tr>
                                <td style="width: 60%; border: 0;"></td>
                                <td style="border: 0;">
                                    Mengetahui,<br>
                                    Kepala Sekolah
                                    <br><br><br><br>
                                    <b><u>${formData.kepsek}</u></b><br>
                                    NIP. ${formData.nipKepsek}
                                </td>
                                <td style="border: 0;">
                                    ........., .................... 20..<br>
                                    Guru Mata Pelajaran
                                    <br><br><br><br>
                                    <b><u>${formData.guru}</u></b><br>
                                    NIP. ${formData.nipGuru}
                                </td>
                            </tr>
                        </table>
                    </div>

                    **FORMAT ASESMEN (Kunci JSON: "asesmen"):**
                    Buat HTML lengkap untuk dokumen lampiran Asesmen yang berisi detail Rubrik dan Instrumen (Awal, Proses, Akhir).
                    
                    Response format: JSON only.
                    {
                        "modul": "HTML String...",
                        "asesmen": "HTML String..."
                    }
                `;

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: prompt }] }],
                            generationConfig: { responseMimeType: "application/json" }
                        })
                    });

                    const data = await response.json();
                    if (data.error) throw new Error(data.error.message);
                    
                    const contentText = data.candidates[0].content.parts[0].text;
                    const jsonResult = JSON.parse(contentText);
                    
                    setResult(jsonResult);
                } catch (err) {
                    setError("Terjadi kesalahan: " + err.message);
                } finally {
                    setIsLoading(false);
                }
            };

            const downloadDoc = (htmlContent, filename) => {
                const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML to Word Document with JavaScript</title><style>table{border-collapse: collapse; width: 100%; border: 1px solid black;} td, th {border: 1px solid black; padding: 5px;}</style></head><body>";
                const footer = `<br><br><div style="text-align:center; font-size:10pt; color:#666; border-top: 1px solid #ccc; padding-top: 10px;">Designed by : Abdul Salim terhubung ke link <a href="https://pakabdulsalim.blogspot.com/">https://pakabdulsalim.blogspot.com/</a></div></body></html>`;
                const sourceHTML = header + htmlContent + footer;

                const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
                const fileDownload = document.createElement("a");
                document.body.appendChild(fileDownload);
                fileDownload.href = source;
                fileDownload.download = `${filename}.doc`;
                fileDownload.click();
                document.body.removeChild(fileDownload);
            };

            return (
                <div className="min-h-screen pb-10 relative">
                    {/* Header Utama dengan Menu Panduan */}
                    <header className="bg-gradient-to-r from-blue-700 to-blue-500 text-white p-6 shadow-lg relative">
                        <div className="flex justify-between items-center max-w-6xl mx-auto">
                            <div className="text-left">
                                <h1 className="text-xl md:text-3xl font-bold mb-1">
                                    Generator Rencana Pembelajaran Mendalam - Deep Learning
                                </h1>
                                <p className="text-sm md:text-lg font-light opacity-90">
                                    Solusi Cerdas Administrasi Guru Indonesia
                                </p>
                            </div>
                            
                            {/* Tombol Menu PANDUAN */}
                            <div className="absolute top-6 right-6 md:static">
                                <button 
                                    onClick={() => setShowGuide(true)}
                                    className="bg-white text-blue-700 hover:bg-yellow-300 hover:text-blue-900 font-bold py-2 px-4 rounded-lg shadow-md transition flex items-center gap-2"
                                >
                                    <i className="fas fa-book-open"></i>
                                    <span>PANDUAN</span>
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* MODAL PANDUAN (Pop-up) */}
                    {showGuide && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
                            {/* Backdrop */}
                            <div 
                                className="absolute inset-0 bg-black bg-opacity-60 backdrop-blur-sm transition-opacity" 
                                onClick={() => setShowGuide(false)}
                            ></div>
                            
                            {/* Modal Content */}
                            <div className="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto relative z-10 animate-fade-in-up">
                                <div className="p-6">
                                    <div className="flex justify-between items-center border-b pb-4 mb-4">
                                        <h2 className="text-2xl font-bold text-gray-800">
                                            <i className="fas fa-info-circle text-blue-600 mr-2"></i>
                                            Panduan Penggunaan
                                        </h2>
                                        <button 
                                            onClick={() => setShowGuide(false)}
                                            className="text-gray-400 hover:text-red-500 transition text-2xl"
                                        >
                                            <i className="fas fa-times"></i>
                                        </button>
                                    </div>

                                    <div className="space-y-6 text-gray-700">
                                        {/* Bagian 1: API Key */}
                                        <div className="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                                            <h3 className="font-bold text-lg text-blue-800 mb-2">1. Cara Mendapatkan Google Gemini API Key</h3>
                                            <ol className="list-decimal ml-5 space-y-1 text-sm">
                                                <li>Kunjungi situs <a href="https://aistudio.google.com/" target="_blank" className="text-blue-600 underline font-bold">Google AI Studio</a>.</li>
                                                <li>Login menggunakan akun Google (Gmail) Anda.</li>
                                                <li>Klik tombol biru bertuliskan <b>"Get API key"</b> atau <b>"Create API key"</b>.</li>
                                                <li>Salin kode kunci yang muncul (biasanya diawali dengan huruf 'AI...').</li>
                                                <li>Tempel (Paste) kode tersebut ke kolom <b>Google API Key</b> di aplikasi ini.</li>
                                            </ol>
                                        </div>

                                        {/* Bagian 2: Penggunaan */}
                                        <div className="bg-green-50 p-4 rounded-lg border-l-4 border-green-500">
                                            <h3 className="font-bold text-lg text-green-800 mb-2">2. Cara Menggunakan Aplikasi</h3>
                                            <ol className="list-decimal ml-5 space-y-1 text-sm">
                                                <li>Pastikan API Key sudah terisi.</li>
                                                <li>Isi <b>Identitas Sekolah</b> dan <b>Data Guru</b> dengan lengkap.</li>
                                                <li>Pilih <b>Jenjang</b>, <b>Kelas</b>, dan <b>Mata Pelajaran</b>.</li>
                                                <li>Salin <b>Capaian Pembelajaran (CP)</b> dari dokumen resmi ke kolom CP.</li>
                                                <li>Tentukan <b>Materi</b>, <b>Tujuan Pembelajaran</b>, dan pilih <b>Model Pembelajaran</b>.</li>
                                                <li>Pilih <b>Dimensi Profil Lulusan</b> (bisa pilih lebih dari satu).</li>
                                                <li>Klik tombol biru besar <b>"Generate Perencanaan Pembelajaran Mendalam"</b>.</li>
                                                <li>Tunggu proses berkedip selesai (sekitar 10-30 detik).</li>
                                                <li>Setelah hasil muncul, klik tombol <b>Download Modul</b> atau <b>Download Asesmen</b> untuk mengunduh file Word (.doc).</li>
                                            </ol>
                                        </div>
                                    </div>

                                    <div className="mt-8 text-center">
                                        <button 
                                            onClick={() => setShowGuide(false)}
                                            className="bg-gray-800 text-white py-2 px-6 rounded-lg hover:bg-gray-900 transition"
                                        >
                                            Tutup Panduan
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="container mx-auto px-4 mt-8 max-w-5xl">
                        
                        {/* API Key Section */}
                        <div className="bg-white rounded-lg shadow-md p-6 mb-6 border-l-4 border-yellow-400">
                            <label className="block text-gray-700 font-bold mb-2">Google API Key (Wajib)</label>
                            <input 
                                type="password" 
                                value={apiKey}
                                onChange={(e) => setApiKey(e.target.value)}
                                className="w-full p-3 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                                placeholder="Masukkan Gemini API Key Anda disini..."
                            />
                            <p className="text-xs text-gray-500 mt-1">API Key diperlukan untuk generate konten cerdas.</p>
                        </div>

                        {/* Form Grid */}
                        <div className={`grid grid-cols-1 md:grid-cols-2 gap-6 ${isLoading ? 'blur-loading pointer-events-none' : ''}`}>
                            
                            {/* Panel Kiri: Identitas Sekolah */}
                            <div className="bg-white rounded-lg shadow-md p-6">
                                <h3 className="text-xl font-bold text-blue-800 mb-4 border-b pb-2"><i className="fas fa-school mr-2"></i>Identitas Sekolah</h3>
                                
                                <div className="space-y-4">
                                    <div>
                                        <label className="label-text">Nama Sekolah</label>
                                        <input name="sekolah" value={formData.sekolah} onChange={handleChange} className="input-field" placeholder="Contoh: SMK N 1 GUNUNG TULEH" />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="label-text">Tahun Ajaran</label>
                                            <input name="tahun" value={formData.tahun} onChange={handleChange} className="input-field" placeholder="2025/2026" />
                                        </div>
                                        <div>
                                            <label className="label-text">Semester</label>
                                            <select name="semester" value={formData.semester} onChange={handleChange} className="input-field">
                                                <option>Ganjil</option>
                                                <option>Genap</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label className="label-text">Nama Guru</label>
                                        <input name="guru" value={formData.guru} onChange={handleChange} className="input-field" placeholder="Abdul Salim, S.Pd" />
                                    </div>
                                    <div>
                                        <label className="label-text">NIP Guru</label>
                                        <input name="nipGuru" value={formData.nipGuru} onChange={handleChange} className="input-field" placeholder="198903..." />
                                    </div>
                                    <div>
                                        <label className="label-text">Nama Kepala Sekolah</label>
                                        <input name="kepsek" value={formData.kepsek} onChange={handleChange} className="input-field" placeholder="Nadhif, M.Pd" />
                                    </div>
                                    <div>
                                        <label className="label-text">NIP Kepala Sekolah</label>
                                        <input name="nipKepsek" value={formData.nipKepsek} onChange={handleChange} className="input-field" placeholder="197903..." />
                                    </div>
                                </div>
                            </div>

                            {/* Panel Kanan: Data Pembelajaran */}
                            <div className="bg-white rounded-lg shadow-md p-6">
                                <h3 className="text-xl font-bold text-green-800 mb-4 border-b pb-2"><i className="fas fa-book-open mr-2"></i>Data Pembelajaran</h3>
                                
                                <div className="space-y-4">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="label-text">Jenjang Pendidikan</label>
                                            <select name="jenjang" value={formData.jenjang} onChange={handleChange} className="input-field">
                                                <option value="SD">SD</option>
                                                <option value="SMP">SMP</option>
                                                <option value="SMA">SMA</option>
                                                <option value="SMK">SMK</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="label-text">Kelas</label>
                                            <select name="kelas" value={formData.kelas} onChange={handleChange} className="input-field">
                                                {classOptions[formData.jenjang].map(k => (
                                                    <option key={k} value={k}>{k}</option>
                                                ))}
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label className="label-text">Mata Pelajaran</label>
                                        <input name="mapel" value={formData.mapel} onChange={handleChange} className="input-field" placeholder="Contoh: Projek IPAS" />
                                    </div>

                                    <div>
                                        <label className="label-text">
                                            Capaian Pembelajaran (
                                            <a 
                                                href="https://drive.google.com/file/d/1gO-wqW0yml9ozMcwIEohjGeTC3R066yN/view?usp=sharing" 
                                                target="_blank" 
                                                rel="noopener noreferrer"
                                                className="text-blue-600 hover:text-blue-800 hover:underline"
                                                title="Klik untuk melihat dokumen CP"
                                            >
                                                CP BSKAP 046 2025
                                            </a>
                                            )
                                        </label>
                                        <textarea name="cp" value={formData.cp} onChange={handleChange} rows="3" className="input-field" placeholder="Salin CP disini..."></textarea>
                                    </div>

                                    <div>
                                        <label className="label-text">Materi / Sub Materi</label>
                                        <input name="materi" value={formData.materi} onChange={handleChange} className="input-field" />
                                    </div>

                                    <div className="bg-green-50 p-3 rounded border border-green-200">
                                        <label className="label-text font-bold text-green-800">Tujuan Pembelajaran</label>
                                        <textarea name="tujuan" value={formData.tujuan} onChange={handleChange} rows="2" className="input-field" placeholder="Contoh: Peserta didik mampu menganalisis..."></textarea>
                                    </div>

                                    <div>
                                        <label className="label-text">Alokasi Waktu</label>
                                        <input name="waktu" value={formData.waktu} onChange={handleChange} className="input-field" placeholder="3 JP (3 x 45 Menit)" />
                                    </div>

                                    <div>
                                        <label className="label-text">Model Pembelajaran</label>
                                        <select name="model" value={formData.model} onChange={handleChange} className="input-field">
                                            {modelOptions.map(m => (
                                                <option key={m} value={m}>{m}</option>
                                            ))}
                                        </select>
                                        <p className="text-xs text-gray-500 mt-1">Sintaks akan otomatis disesuaikan ke Deep Learning.</p>
                                    </div>

                                    {/* CHECKBOX Dimensi Profil Lulusan */}
                                    <div>
                                        <label className="label-text mb-2">Dimensi Profil Lulusan (Bisa pilih lebih dari satu)</label>
                                        <div className="bg-gray-50 p-3 rounded border border-gray-300 grid grid-cols-1 gap-2 max-h-60 overflow-y-auto">
                                            {profilLulusanOptions.map((option) => (
                                                <label key={option} className="flex items-center space-x-2 cursor-pointer hover:bg-gray-100 p-1 rounded">
                                                    <input 
                                                        type="checkbox" 
                                                        value={option}
                                                        checked={formData.profil.includes(option)}
                                                        onChange={() => handleProfilChange(option)}
                                                        className="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                                                    />
                                                    <span className="text-sm text-gray-700">{option}</span>
                                                </label>
                                            ))}
                                        </div>
                                        {formData.profil && (
                                            <p className="text-xs text-blue-600 mt-2">
                                                <b>Terpilih:</b> {formData.profil}
                                            </p>
                                        )}
                                    </div>

                                </div>
                            </div>
                        </div>

                        {/* Generate Button */}
                        <div className="mt-8 text-center">
                            {isLoading ? (
                                <div className="blink text-xl">
                                    <i className="fas fa-spinner fa-spin mr-2"></i>
                                    Sedang melakukan proses pembuatan perencanaan pembelajaran mendalam...
                                </div>
                            ) : (
                                <button 
                                    onClick={generateContent}
                                    className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-full shadow-lg transform transition hover:scale-105 text-lg"
                                >
                                    <i className="fas fa-magic mr-2"></i>
                                    Generate Perencanaan Pembelajaran Mendalam
                                </button>
                            )}
                            {error && <p className="text-red-500 mt-4 font-bold">{error}</p>}
                        </div>

                        {/* Result Section */}
                        {result && (
                            <div className="mt-12 animate-fade-in-up">
                                <div className="bg-white p-6 rounded-t-lg border-b flex justify-between items-center bg-gray-50">
                                    <h2 className="text-2xl font-bold text-gray-800">Hasil Dokumen</h2>
                                    <div className="space-x-4">
                                        <button 
                                            onClick={() => downloadDoc(result.modul, `Modul_Ajar_${formData.mapel}`)}
                                            className="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded shadow flex items-center gap-2"
                                        >
                                            <i className="fas fa-file-word"></i> Download Modul (.doc)
                                        </button>
                                        <button 
                                            onClick={() => downloadDoc(result.asesmen, `Asesmen_${formData.mapel}`)}
                                            className="bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded shadow flex items-center gap-2"
                                        >
                                            <i className="fas fa-file-word"></i> Download Asesmen (.doc)
                                        </button>
                                    </div>
                                </div>

                                {/* Preview Area */}
                                <div className="bg-white p-8 border border-gray-200 shadow-lg min-h-[500px] overflow-auto">
                                    <div className="mb-8 border-b pb-4">
                                        <h3 className="text-lg font-bold text-gray-400 mb-2 uppercase tracking-wide">Preview Modul Ajar</h3>
                                        <div className="doc-preview text-gray-800" dangerouslySetInnerHTML={{ __html: result.modul }}></div>
                                    </div>
                                    <div>
                                        <h3 className="text-lg font-bold text-gray-400 mb-2 uppercase tracking-wide">Preview Asesmen</h3>
                                        <div className="doc-preview text-gray-800" dangerouslySetInnerHTML={{ __html: result.asesmen }}></div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Footer */}
                    <footer className="mt-12 bg-gray-800 text-white text-center py-6">
                        <p className="mb-2">
                            Designed by : <span className="font-bold text-blue-400">Abdul Salim</span>
                            <span className="mx-2 text-gray-500">|</span>
                            <a 
                                href="https://drive.google.com/file/d/1YxKFrGWocIhkF73-KHAcZ85UPz_cA_WX/view?usp=sharing" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                className="font-bold text-yellow-400 hover:text-yellow-300 hover:underline"
                            >
                                Struktur
                            </a>
                        </p>
                        <a href="https://pakabdulsalim.blogspot.com/" target="_blank" className="text-sm text-gray-400 hover:text-white transition">
                            https://pakabdulsalim.blogspot.com/
                        </a>
                    </footer>

                    {/* Custom Styles for Input */}
                    <style>{`
                        .label-text {
                            display: block;
                            font-size: 0.875rem;
                            font-weight: 600;
                            color: #374151;
                            margin-bottom: 0.25rem;
                        }
                        .input-field {
                            width: 100%;
                            padding: 0.5rem 0.75rem;
                            border: 1px solid #d1d5db;
                            border-radius: 0.375rem;
                            transition: all 0.2s;
                        }
                        .input-field:focus {
                            outline: none;
                            border-color: #3b82f6;
                            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
                        }
                        @keyframes fadeInUp {
                            from { opacity: 0; transform: translateY(20px); }
                            to { opacity: 1; transform: translateY(0); }
                        }
                        .animate-fade-in-up {
                            animation: fadeInUp 0.5s ease-out forwards;
                        }
                    `}</style>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
